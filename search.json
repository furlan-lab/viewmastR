[{"path":"https://furlan-lab.github.io/viewmastR/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 Scott N Furlan Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/articles/Augment.html","id":"installing-rust","dir":"Articles","previous_headings":"","what":"Installing Rust","title":"How to augment data using viewmastR","text":"First need updated Rust installation. Go site learn install Rust.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/articles/Augment.html","id":"installing-viewmastr","dir":"Articles","previous_headings":"","what":"Installing viewmastR","title":"How to augment data using viewmastR","text":"need devtools package installed…","code":"devtools::install_github(\"furlan-lab/viewmastR\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/Augment.html","id":"load-a-dataset","dir":"Articles","previous_headings":"","what":"Load a dataset","title":"How to augment data using viewmastR","text":"","code":"suppressPackageStartupMessages({ library(viewmastR) library(Seurat) library(ggplot2) library(scCustomize) library(magrittr) })   #query dataset seu<-readRDS(file.path(ROOT_DIR1, \"220302_final_object.RDS\"))"},{"path":"https://furlan-lab.github.io/viewmastR/articles/Augment.html","id":"lets-first-fix-this-dataset-and-label-with-tregs","dir":"Articles","previous_headings":"","what":"Let’s first fix this dataset and label with Tregs","title":"How to augment data using viewmastR","text":"Tregs located cluster 9 (evidenced FOXP3 expression), don’t correct label. Let’s fix .       Better…","code":"DimPlot_scCustom(seu, group.by = \"celltype\") Idents(seu)<-seu$celltype Cluster_Highlight_Plot(seu, cluster_name = \"Treg\") DimPlot_scCustom(seu, group.by = \"seurat_clusters\") FeaturePlot_scCustom(seu, features = \"FOXP3\") seu$celltype[seu$seurat_clusters %in% \"9\"]<-\"Treg\" DimPlot_scCustom(seu, group.by = \"celltype\") Idents(seu)<-seu$celltype Cluster_Highlight_Plot(seu, cluster_name = \"Treg\") table(seu$celltype) ##  ##    B Memory     B Naive   Basophils   CD14 Mono   CD16 Mono  CD4 Memory  ##         199         666           9        3626         722        2115  ##   CD4 Naive  CD8 Memory   CD8 Naive         cDC Neutrophils          NK  ##        1142        1209         388         127           9         843  ##         pDC        Treg  ##           3         250"},{"path":"https://furlan-lab.github.io/viewmastR/articles/Augment.html","id":"lets-augment-rare-celltypes-for-better-learning-but-bringing-any-celltype-to-a-minimum-of-1500-cells--use-the-prune-option-to-downsample-any-celltypes-present-above-the-norm_number-down-to-that-number-","dir":"Articles","previous_headings":"","what":"Let’s augment rare celltypes for better learning but bringing any celltype to a minimum of 1500 cells. use the prune option to downsample any celltypes present above the norm_number down to that number.","title":"How to augment data using viewmastR","text":"","code":"seuA<-augment_data(seu, \"celltype\", norm_number = 500, prune = T) seuA <- FindVariableFeatures(seuA, selection.method = \"vst\", nfeatures = 3000) %>% NormalizeData() %>% ScaleData() seuA <- RunPCA(seuA, features = VariableFeatures(object = seuA), npcs = 50) ElbowPlot(seuA, 50) seuA<- FindNeighbors(seuA, dims = 1:40) %>% FindClusters(resolution = 2) %>% RunUMAP(dims = 1:40, n.components = 2) ## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck ##  ## Number of nodes: 7000 ## Number of edges: 363484 ##  ## Running Louvain algorithm... ## Maximum modularity in 10 random starts: 0.8507 ## Number of communities: 17 ## Elapsed time: 0 seconds DimPlot_scCustom(seuA, group.by = \"celltype\") FeaturePlot_scCustom(seuA, features = \"FOXP3\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/Augment.html","id":"now-we-train-another-pbmc-dataset-with-labels-for-tregs-that-are-questionable-and-see-if-we-can-find-them","dir":"Articles","previous_headings":"","what":"Now we train another PBMC dataset with labels for tregs that are questionable and see if we can find them","title":"How to augment data using viewmastR","text":"","code":"seu<-readRDS(file.path(ROOT_DIR3, \"240919_5p_seu.RDS\"))  seu<-calculate_gene_dispersion(seu) seu<-select_genes(seu, top_n = 10000, logmean_ul = -1, logmean_ll = -8) vgq<-get_selected_genes(seu)  seuA<-calculate_gene_dispersion(seuA) seuA<-select_genes(seuA, top_n = 10000, logmean_ul = -1, logmean_ll = -8) vgr<-get_selected_genes(seuA)  vg<-intersect(vgq, vgr)  seu<-viewmastR(seu, seuA, ref_celldata_col = \"celltype\", selected_genes = vg)  DimPlot_scCustom(seu, group.by = \"mCelltype\") #need to fix spelling error #seu$mCelltype[seu$mCelltype==\"Jeutrophils\"]<-\"Neutrophils\" DimPlot_scCustom(seu, group.by = \"viewmastR_pred\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/Augment.html","id":"a-confusion-matrix-showing-prediction-vs-ground-truth","dir":"Articles","previous_headings":"","what":"A confusion matrix showing prediction vs ground truth","title":"How to augment data using viewmastR","text":"","code":"co<-as.character(pals::polychrome(length(levels(factor(c(seu$mCelltype, seu$viewmastR_pred)))))) names(co)<-levels(factor(c(seu$mCelltype, seu$viewmastR_pred))) confusion_matrix(pred = factor(seu$viewmastR_pred), gt = factor(seu$mCelltype), cols = co) Idents(seu)<-seu$viewmastR_pred VlnPlot_scCustom(seu, features = \"FOXP3\") Idents(seu)<-seu$mCelltype VlnPlot_scCustom(seu, features = \"FOXP3\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/Augment.html","id":"appendix","dir":"Articles","previous_headings":"","what":"Appendix","title":"How to augment data using viewmastR","text":"","code":"sessionInfo() ## R version 4.3.1 (2023-06-16) ## Platform: x86_64-apple-darwin20 (64-bit) ## Running under: macOS Sonoma 14.6.1 ##  ## Matrix products: default ## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/Los_Angeles ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] magrittr_2.0.3     scCustomize_2.1.2  ggplot2_3.5.0      Seurat_5.0.3       ## [5] SeuratObject_5.0.1 sp_2.1-3           viewmastR_0.2.3    ##  ## loaded via a namespace (and not attached): ##   [1] fs_1.6.3                    matrixStats_1.2.0           ##   [3] spatstat.sparse_3.0-3       bitops_1.0-7                ##   [5] RcppMsgPack_0.2.3           lubridate_1.9.3             ##   [7] httr_1.4.7                  RColorBrewer_1.1-3          ##   [9] doParallel_1.0.17           tools_4.3.1                 ##  [11] sctransform_0.4.1           backports_1.4.1             ##  [13] utf8_1.2.4                  R6_2.5.1                    ##  [15] lazyeval_0.2.2              uwot_0.1.16                 ##  [17] GetoptLong_1.0.5            withr_3.0.0                 ##  [19] gridExtra_2.3               progressr_0.14.0            ##  [21] cli_3.6.2                   Biobase_2.60.0              ##  [23] textshaping_0.3.7           Cairo_1.6-2                 ##  [25] spatstat.explore_3.2-6      fastDummies_1.7.3           ##  [27] labeling_0.4.3              prismatic_1.1.1             ##  [29] sass_0.4.9                  spatstat.data_3.0-4         ##  [31] proxy_0.4-27                ggridges_0.5.6              ##  [33] pbapply_1.7-2               pkgdown_2.0.7               ##  [35] systemfonts_1.0.6           foreign_0.8-86              ##  [37] dichromat_2.0-0.1           parallelly_1.37.1           ##  [39] maps_3.4.2                  pals_1.8                    ##  [41] rstudioapi_0.15.0           generics_0.1.3              ##  [43] shape_1.4.6.1               ica_1.0-3                   ##  [45] spatstat.random_3.2-3       dplyr_1.1.4                 ##  [47] Matrix_1.6-5                ggbeeswarm_0.7.2            ##  [49] fansi_1.0.6                 S4Vectors_0.38.2            ##  [51] abind_1.4-5                 lifecycle_1.0.4             ##  [53] yaml_2.3.8                  snakecase_0.11.1            ##  [55] SummarizedExperiment_1.30.2 recipes_1.0.10              ##  [57] Rtsne_0.17                  paletteer_1.6.0             ##  [59] grid_4.3.1                  promises_1.2.1              ##  [61] crayon_1.5.2                miniUI_0.1.1.1              ##  [63] lattice_0.22-5              cowplot_1.1.3               ##  [65] mapproj_1.2.11              pillar_1.9.0                ##  [67] knitr_1.45                  ComplexHeatmap_2.16.0       ##  [69] GenomicRanges_1.52.1        rjson_0.2.21                ##  [71] boot_1.3-28.1               future.apply_1.11.1         ##  [73] codetools_0.2-19            leiden_0.4.3.1              ##  [75] glue_1.7.0                  data.table_1.15.2           ##  [77] vctrs_0.6.5                 png_0.1-8                   ##  [79] spam_2.10-0                 gtable_0.3.4                ##  [81] rematch2_2.1.2              assertthat_0.2.1            ##  [83] cachem_1.0.8                gower_1.0.1                 ##  [85] xfun_0.42                   S4Arrays_1.2.0              ##  [87] mime_0.12                   prodlim_2023.08.28          ##  [89] survival_3.5-7              timeDate_4032.109           ##  [91] SingleCellExperiment_1.22.0 iterators_1.0.14            ##  [93] pbmcapply_1.5.1             hardhat_1.3.1               ##  [95] lava_1.8.0                  ellipsis_0.3.2              ##  [97] fitdistrplus_1.1-11         ROCR_1.0-11                 ##  [99] ipred_0.9-14                nlme_3.1-164                ## [101] RcppAnnoy_0.0.22            GenomeInfoDb_1.41.1         ## [103] bslib_0.6.1                 irlba_2.3.5.1               ## [105] vipor_0.4.7                 KernSmooth_2.23-22          ## [107] rpart_4.1.23                colorspace_2.1-0            ## [109] BiocGenerics_0.46.0         Hmisc_5.1-2                 ## [111] nnet_7.3-19                 ggrastr_1.0.2               ## [113] tidyselect_1.2.1            compiler_4.3.1              ## [115] htmlTable_2.4.2             desc_1.4.3                  ## [117] DelayedArray_0.26.7         plotly_4.10.4               ## [119] checkmate_2.3.1             scales_1.3.0                ## [121] lmtest_0.9-40               stringr_1.5.1               ## [123] digest_0.6.35               goftest_1.2-3               ## [125] spatstat.utils_3.1-0        minqa_1.2.6                 ## [127] rmarkdown_2.26              XVector_0.40.0              ## [129] htmltools_0.5.7             pkgconfig_2.0.3             ## [131] base64enc_0.1-3             lme4_1.1-35.1               ## [133] sparseMatrixStats_1.12.2    MatrixGenerics_1.12.3       ## [135] highr_0.10                  fastmap_1.1.1               ## [137] rlang_1.1.3                 GlobalOptions_0.1.2         ## [139] htmlwidgets_1.6.4           UCSC.utils_1.1.0            ## [141] shiny_1.8.0                 DelayedMatrixStats_1.22.6   ## [143] farver_2.1.1                jquerylib_0.1.4             ## [145] zoo_1.8-12                  jsonlite_1.8.8              ## [147] ModelMetrics_1.2.2.2        RCurl_1.98-1.14             ## [149] Formula_1.2-5               GenomeInfoDbData_1.2.10     ## [151] dotCall64_1.1-1             patchwork_1.2.0             ## [153] munsell_0.5.0               Rcpp_1.0.12                 ## [155] reticulate_1.35.0           stringi_1.8.3               ## [157] pROC_1.18.5                 zlibbioc_1.46.0             ## [159] MASS_7.3-60.0.1             plyr_1.8.9                  ## [161] parallel_4.3.1              listenv_0.9.1               ## [163] ggrepel_0.9.5               forcats_1.0.0               ## [165] deldir_2.0-4                splines_4.3.1               ## [167] tensor_1.5                  circlize_0.4.16             ## [169] igraph_2.0.3                spatstat.geom_3.2-9         ## [171] RcppHNSW_0.6.0              reshape2_1.4.4              ## [173] stats4_4.3.1                evaluate_0.23               ## [175] ggprism_1.0.4               nloptr_2.0.3                ## [177] foreach_1.5.2               httpuv_1.6.14               ## [179] RANN_2.6.1                  tidyr_1.3.1                 ## [181] purrr_1.0.2                 polyclip_1.10-6             ## [183] future_1.33.1               clue_0.3-65                 ## [185] scattermore_1.2             janitor_2.2.0               ## [187] xtable_1.8-4                monocle3_1.4.3              ## [189] e1071_1.7-14                RSpectra_0.16-1             ## [191] later_1.3.2                 viridisLite_0.4.2           ## [193] class_7.3-22                ragg_1.3.0                  ## [195] tibble_3.2.1                memoise_2.0.1               ## [197] beeswarm_0.4.0              IRanges_2.34.1              ## [199] cluster_2.1.6               timechange_0.3.0            ## [201] globals_0.16.3              caret_6.0-94 getwd() ## [1] \"/Users/sfurlan/develop/viewmastR/vignettes\""},{"path":"https://furlan-lab.github.io/viewmastR/articles/BulkReference.html","id":"installing-rust","dir":"Articles","previous_headings":"","what":"Installing Rust","title":"How to use a bulk dataset as a reference for viewmastR","text":"First need updated Rust installation. Go site learn install Rust.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/articles/BulkReference.html","id":"installing-viewmastr","dir":"Articles","previous_headings":"","what":"Installing viewmastR","title":"How to use a bulk dataset as a reference for viewmastR","text":"need devtools package installed…","code":"devtools::install_github(\"furlan-lab/viewmastR\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/BulkReference.html","id":"load-a-few-datasets","dir":"Articles","previous_headings":"","what":"Load a few datasets","title":"How to use a bulk dataset as a reference for viewmastR","text":"","code":"suppressPackageStartupMessages({ library(viewmastR) library(Seurat)   library(SeuratObject) library(ggplot2) library(scCustomize) library(magrittr) library(SummarizedExperiment) })  #malignant ref (bulk) seuMR<-readRDS(file.path(ROOT_DIR1, \"240126_AML_object.RDS\")) seMR<-readRDS(file.path(ROOT_DIR1, \"240126_Combined_SE_Object.RDS\"))  #healthy ref (sc) seuHR <- readRDS(file.path(ROOT_DIR3, \"230329_rnaAugmented_seurat.RDS\"))  #query dataset seuP<-readRDS(file.path(ROOT_DIR2, \"220831_ptdata.RDS\"))"},{"path":"https://furlan-lab.github.io/viewmastR/articles/BulkReference.html","id":"make-a-bulk-classifier","dir":"Articles","previous_headings":"","what":"Make a bulk classifier","title":"How to use a bulk dataset as a reference for viewmastR","text":"can see classifies cells scRNAseq experiment. first done loading data creating [Summarized Experiment] (https://bioconductor.org/packages/release/bioc/html/SummarizedExperiment.html). remove malignant/modified cells reference. function “splat_bulk_reference” takes SummarizedExperiment returns Seurat object made generating pseudo-single-cell data can used reference viewmastR. invoke viewmastR. Although necessary, can visualize UMAP single-cellified bulk reference using standard Seurat workflow. Finally, can visualize bulk viewmastR classification result compared published cell labels. , see fairly faithful overlap, bulk reference contain samples celltypes, cells plasma cells cDCs called celltypes.","code":"dat<-read.table(allcounts, header = T) rownames(dat)<-dat$X_TranscriptID dat$X_TranscriptID<-NULL metad<-data.frame(sample = strsplit(colnames(dat), \"\\\\.\") %>% sapply(\"[[\", 1), celltype = strsplit(colnames(dat), \"\\\\.\") %>% sapply(\"[[\", 2)) rowd<-DataFrame(gene_short_name = rownames(dat), row.names = rownames(dat)) obj<-SummarizedExperiment::SummarizedExperiment(assays = list(counts=dat), rowData = rowd, colData = metad)   #remove samples we don't want obj<-obj[,!grepl(\"^Blast\", obj$celltype)] #blasts obj<-obj[,!grepl(\"^rHSC\", obj$celltype)] #recombinant HSCs obj<-obj[,!grepl(\"^LSC\", obj$celltype)] #leukemia stem cells #obj<-obj[,obj$sample %in% c(\"X5852\", \"X5483\")] #two donors  #undebug(splat_bulk_reference) seuF<-splat_bulk_reference(seuHR, obj, N=200)  seuF<-NormalizeData(seuF) seuF <- FindVariableFeatures(seuF,  nfeatures = 1000, assay = \"RNA\") seuF <- ScaleData(seuF) %>% RunPCA(features = VariableFeatures(object = seuF), npcs = 100) ElbowPlot(seuF, 100) seuF<- FindNeighbors(seuF, dims = 1:20) seuF <- FindClusters(seuF, resolution = 1.1) ## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck ##  ## Number of nodes: 9800 ## Number of edges: 359668 ##  ## Running Louvain algorithm... ## Maximum modularity in 10 random starts: 0.9499 ## Number of communities: 36 ## Elapsed time: 0 seconds seuF <- RunUMAP(seuF, dims = 1:20, n.components = 2, min.dist = 0.6) DimPlot(seuF, group.by = \"celltype\", cols = as.character(pals::polychrome(20))) DimPlot(seuF, group.by = \"sample\", cols = as.character(pals::polychrome(20))) seuF<-calculate_gene_dispersion(seuF) seuF<-select_genes(seuF, top_n = 10000, logmean_ul = -1, logmean_ll = -8) vgr<-get_selected_genes(seuF) seuHR<-calculate_gene_dispersion(seuHR) seuHR<-select_genes(seuHR, top_n = 10000, logmean_ul = -1, logmean_ll = -8) vgq<-get_selected_genes(seuHR) vg<-intersect(vgq, vgr)  seuHR<-viewmastR::viewmastR(query_cds = seuHR, ref_cds = seuF, ref_celldata_col = \"celltype\", selected_genes = vg) cols<-c(seuHR@misc$colors[c(14,18,20,6,5,3,7,1,5,2,11)], \"cyan\", seuHR@misc$colors[c(21)]) names(cols)<-levels(factor(seuF$celltype))  DimPlot_scCustom(seuHR, group.by = \"viewmastR_pred\", colors_use  = cols, label = T, repel = T, label.box = T, label.color = \"white\") DimPlot_scCustom(seuHR, group.by = \"SFClassification\", colors_use  = seuHR@misc$colors, label = T, repel = T, label.box = T, label.color = \"white\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/BulkReference.html","id":"lets-look-at-a-patient","dir":"Articles","previous_headings":"","what":"Let’s look at a patient","title":"How to use a bulk dataset as a reference for viewmastR","text":"patient post transplant evidence chimerism. Let’s run viewmastR using reference healthy BM cells see cells annotate","code":"seuP<-calculate_gene_dispersion(seuP) seuP<-select_genes(seuP, top_n = 10000, logmean_ul = -1, logmean_ll = -8) vgr<-get_selected_genes(seuP) seuHR<-calculate_gene_dispersion(seuHR) seuHR<-select_genes(seuHR, top_n = 10000, logmean_ul = -1, logmean_ll = -8) vgq<-get_selected_genes(seuHR) vg<-intersect(vgq, vgr) seuP<-viewmastR::viewmastR(query_cds = seuP, ref_cds = seuHR, ref_celldata_col = \"SFClassification\", selected_genes = vg)  DimPlot_scCustom(seuP, group.by = \"viewmastR_pred\", colors_use = seuHR@misc$colors) seuP$geno_label<-seuP$geno seuP$geno_label[seuP$geno %in% \"0\"]<-\"Donor\" seuP$geno_label[seuP$geno %in% \"1\"]<-\"Recipient\" DimPlot_scCustom(seuP, group.by = \"geno_label\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/BulkReference.html","id":"interesting-that-we-see-some-lymphoidb-signature-in-this-patient-with-a-runx1-runx1t1-fusion","dir":"Articles","previous_headings":"","what":"Interesting that we see some lymphoid/B signature in this patient with a RUNX1-RUNX1T1 fusion","title":"How to use a bulk dataset as a reference for viewmastR","text":"","code":"Idents(seuP)<-seuP$viewmastR_pred #levels(factor(as.character(seuP$viewmastR_pred))) Cluster_Highlight_Plot(seuP, cluster_name = \"06_CLP\", highlight_color = seuHR@misc$colors) Cluster_Highlight_Plot(seuP, cluster_name = \"13_Pre.B\", highlight_color = seuHR@misc$colors) Cluster_Highlight_Plot(seuP, cluster_name = \"14_B\", highlight_color = seuHR@misc$colors)"},{"path":"https://furlan-lab.github.io/viewmastR/articles/BulkReference.html","id":"lets-investigate-how-the-tumor-annotates-using-a-bulk-reference-of-leukemia-cases","dir":"Articles","previous_headings":"","what":"Let’s investigate how the tumor annotates using a bulk reference of leukemia cases","title":"How to use a bulk dataset as a reference for viewmastR","text":"First pare data min 3 max 20 cases per leukemia subgroup. make 10 cells case, use resulting reference classify patient sample. seems Ph signature case even though majority tumor cells annotate correctly RUNX1-RUNX1T1","code":"obj<-seMR #rowData(obj) sttk<-names(table(obj$final_group))[table(obj$final_group)>3] sttk<-sttk[!sttk %in% \"Other\"] case_max<-20  obj<-obj[,obj$final_group %in% sttk] ds<-names(table(obj$final_group))[table(obj$final_group)>20] ctk<-lapply(names(table(obj$final_group)), function(type){   cases<-which(obj$final_group %in% type)   if (length(cases)>case_max){     cases<-sample(cases, case_max)   }   cases }) obj<-obj[,unlist(ctk)[order(unlist(ctk))]] #table(obj$final_group)  #debug(splat_bulk_reference) seuF<-splat_bulk_reference(seuP, obj, N=10)  seuF<-NormalizeData(seuF) seuF <- FindVariableFeatures(seuF,  nfeatures = 1000, assay = \"RNA\") seuF <- ScaleData(seuF) %>% RunPCA(features = VariableFeatures(object = seuF), npcs = 100) ElbowPlot(seuF, 100) seuF<- FindNeighbors(seuF, dims = 1:20) seuF <- FindClusters(seuF, resolution = 1.1) ## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck ##  ## Number of nodes: 7360 ## Number of edges: 201781 ##  ## Running Louvain algorithm... ## Maximum modularity in 10 random starts: 0.9028 ## Number of communities: 35 ## Elapsed time: 0 seconds seuF <- RunUMAP(seuF, dims = 1:20, n.components = 2, min.dist = 0.2) seuF<-calculate_gene_dispersion(seuF) seuF<-select_genes(seuF, top_n = 10000, logmean_ul = -1, logmean_ll = -8) vgr<-get_selected_genes(seuF) seuP<-calculate_gene_dispersion(seuP) seuP<-select_genes(seuP, top_n = 10000, logmean_ul = -1, logmean_ll = -8) vgq<-get_selected_genes(seuP) vg<-intersect(vgq, vgr)  seuP<-viewmastR::viewmastR(query_cds = seuP, ref_cds = seuF, ref_celldata_col = \"final_group\", selected_genes = vg)  thresh<-100 seuP$pred_thresh<-seuP$viewmastR_pred seuP$pred_thresh[seuP$pred_thresh %in% names(table(seuP$viewmastR_pred))[table(seuP$viewmastR_pred)<thresh]]<-\"Other\" DimPlot_scCustom(seuP, group.by = \"pred_thresh\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/BulkReference.html","id":"appendix","dir":"Articles","previous_headings":"","what":"Appendix","title":"How to use a bulk dataset as a reference for viewmastR","text":"","code":"sessionInfo() ## R version 4.3.1 (2023-06-16) ## Platform: x86_64-apple-darwin20 (64-bit) ## Running under: macOS Sonoma 14.6.1 ##  ## Matrix products: default ## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/Los_Angeles ## tzcode source: internal ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] SummarizedExperiment_1.30.2 Biobase_2.60.0              ##  [3] GenomicRanges_1.52.1        GenomeInfoDb_1.41.1         ##  [5] IRanges_2.34.1              S4Vectors_0.38.2            ##  [7] BiocGenerics_0.46.0         MatrixGenerics_1.12.3       ##  [9] matrixStats_1.2.0           magrittr_2.0.3              ## [11] scCustomize_2.1.2           ggplot2_3.5.0               ## [13] Seurat_5.0.3                SeuratObject_5.0.1          ## [15] sp_2.1-3                    viewmastR_0.2.3             ##  ## loaded via a namespace (and not attached): ##   [1] fs_1.6.3                    spatstat.sparse_3.0-3       ##   [3] bitops_1.0-7                RcppMsgPack_0.2.3           ##   [5] lubridate_1.9.3             httr_1.4.7                  ##   [7] RColorBrewer_1.1-3          doParallel_1.0.17           ##   [9] tools_4.3.1                 sctransform_0.4.1           ##  [11] backports_1.4.1             utf8_1.2.4                  ##  [13] R6_2.5.1                    lazyeval_0.2.2              ##  [15] uwot_0.1.16                 GetoptLong_1.0.5            ##  [17] withr_3.0.0                 gridExtra_2.3               ##  [19] progressr_0.14.0            cli_3.6.2                   ##  [21] textshaping_0.3.7           spatstat.explore_3.2-6      ##  [23] fastDummies_1.7.3           prismatic_1.1.1             ##  [25] labeling_0.4.3              sass_0.4.9                  ##  [27] spatstat.data_3.0-4         ggridges_0.5.6              ##  [29] pbapply_1.7-2               pkgdown_2.0.7               ##  [31] systemfonts_1.0.6           foreign_0.8-86              ##  [33] dichromat_2.0-0.1           parallelly_1.37.1           ##  [35] maps_3.4.2                  pals_1.8                    ##  [37] rstudioapi_0.15.0           generics_0.1.3              ##  [39] shape_1.4.6.1               ica_1.0-3                   ##  [41] spatstat.random_3.2-3       dplyr_1.1.4                 ##  [43] Matrix_1.6-5                ggbeeswarm_0.7.2            ##  [45] fansi_1.0.6                 abind_1.4-5                 ##  [47] lifecycle_1.0.4             yaml_2.3.8                  ##  [49] snakecase_0.11.1            recipes_1.0.10              ##  [51] Rtsne_0.17                  paletteer_1.6.0             ##  [53] grid_4.3.1                  promises_1.2.1              ##  [55] crayon_1.5.2                miniUI_0.1.1.1              ##  [57] lattice_0.22-5              cowplot_1.1.3               ##  [59] mapproj_1.2.11              pillar_1.9.0                ##  [61] knitr_1.45                  ComplexHeatmap_2.16.0       ##  [63] rjson_0.2.21                boot_1.3-28.1               ##  [65] future.apply_1.11.1         codetools_0.2-19            ##  [67] leiden_0.4.3.1              glue_1.7.0                  ##  [69] data.table_1.15.2           vctrs_0.6.5                 ##  [71] png_0.1-8                   spam_2.10-0                 ##  [73] gtable_0.3.4                rematch2_2.1.2              ##  [75] assertthat_0.2.1            cachem_1.0.8                ##  [77] gower_1.0.1                 xfun_0.42                   ##  [79] S4Arrays_1.2.0              mime_0.12                   ##  [81] prodlim_2023.08.28          survival_3.5-7              ##  [83] timeDate_4032.109           SingleCellExperiment_1.22.0 ##  [85] iterators_1.0.14            pbmcapply_1.5.1             ##  [87] hardhat_1.3.1               lava_1.8.0                  ##  [89] ellipsis_0.3.2              fitdistrplus_1.1-11         ##  [91] ROCR_1.0-11                 ipred_0.9-14                ##  [93] nlme_3.1-164                RcppAnnoy_0.0.22            ##  [95] bslib_0.6.1                 irlba_2.3.5.1               ##  [97] vipor_0.4.7                 KernSmooth_2.23-22          ##  [99] rpart_4.1.23                colorspace_2.1-0            ## [101] Hmisc_5.1-2                 nnet_7.3-19                 ## [103] ggrastr_1.0.2               tidyselect_1.2.1            ## [105] compiler_4.3.1              htmlTable_2.4.2             ## [107] desc_1.4.3                  DelayedArray_0.26.7         ## [109] plotly_4.10.4               checkmate_2.3.1             ## [111] scales_1.3.0                lmtest_0.9-40               ## [113] stringr_1.5.1               digest_0.6.35               ## [115] goftest_1.2-3               spatstat.utils_3.1-0        ## [117] minqa_1.2.6                 rmarkdown_2.26              ## [119] XVector_0.40.0              htmltools_0.5.7             ## [121] pkgconfig_2.0.3             base64enc_0.1-3             ## [123] lme4_1.1-35.1               sparseMatrixStats_1.12.2    ## [125] highr_0.10                  fastmap_1.1.1               ## [127] rlang_1.1.3                 GlobalOptions_0.1.2         ## [129] htmlwidgets_1.6.4           UCSC.utils_1.1.0            ## [131] shiny_1.8.0                 DelayedMatrixStats_1.22.6   ## [133] farver_2.1.1                jquerylib_0.1.4             ## [135] zoo_1.8-12                  jsonlite_1.8.8              ## [137] ModelMetrics_1.2.2.2        RCurl_1.98-1.14             ## [139] Formula_1.2-5               GenomeInfoDbData_1.2.10     ## [141] dotCall64_1.1-1             patchwork_1.2.0             ## [143] munsell_0.5.0               Rcpp_1.0.12                 ## [145] reticulate_1.35.0           stringi_1.8.3               ## [147] pROC_1.18.5                 zlibbioc_1.46.0             ## [149] MASS_7.3-60.0.1             plyr_1.8.9                  ## [151] parallel_4.3.1              listenv_0.9.1               ## [153] ggrepel_0.9.5               forcats_1.0.0               ## [155] deldir_2.0-4                splines_4.3.1               ## [157] tensor_1.5                  circlize_0.4.16             ## [159] igraph_2.0.3                spatstat.geom_3.2-9         ## [161] RcppHNSW_0.6.0              reshape2_1.4.4              ## [163] evaluate_0.23               ggprism_1.0.4               ## [165] nloptr_2.0.3                foreach_1.5.2               ## [167] httpuv_1.6.14               RANN_2.6.1                  ## [169] tidyr_1.3.1                 purrr_1.0.2                 ## [171] polyclip_1.10-6             future_1.33.1               ## [173] clue_0.3-65                 scattermore_1.2             ## [175] janitor_2.2.0               xtable_1.8-4                ## [177] monocle3_1.4.3              RSpectra_0.16-1             ## [179] later_1.3.2                 viridisLite_0.4.2           ## [181] class_7.3-22                ragg_1.3.0                  ## [183] tibble_3.2.1                memoise_2.0.1               ## [185] beeswarm_0.4.0              cluster_2.1.6               ## [187] timechange_0.3.0            globals_0.16.3              ## [189] caret_6.0-94 getwd() ## [1] \"/Users/sfurlan/develop/viewmastR/vignettes\""},{"path":"https://furlan-lab.github.io/viewmastR/articles/HowTo.html","id":"prerequisites","dir":"Articles","previous_headings":"","what":"Prerequisites","title":"How to use viewmastR","text":"begin, ensure updated Rust installation, ’s core dependency. can follow instructions provided official Rust installation page.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/articles/HowTo.html","id":"installing-viewmastr","dir":"Articles","previous_headings":"","what":"Installing viewmastR","title":"How to use viewmastR","text":"First, ensure devtools R package installed, allows install packages GitHub. devtools installed, can easily install viewmastR using following command: fetch latest version viewmastR GitHub install .","code":"devtools::install_github(\"furlan-lab/viewmastR\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/HowTo.html","id":"running-viewmastr","dir":"Articles","previous_headings":"","what":"Running viewmastR","title":"How to use viewmastR","text":"section, ’ll load two Seurat objects: - Query dataset (seu): Contains data want classify. - Reference dataset (seur): Contains known cell type labels used train model. ViewmastR predicts cell types query dataset leveraging features associated cell type labels reference data.","code":"# Load required packages suppressPackageStartupMessages({   library(viewmastR)   library(Seurat)   library(ggplot2)   library(scCustomize) })   # Load query and reference datasets seu <- readRDS(file.path(ROOT_DIR1, \"240813_final_object.RDS\")) seur <- readRDS(file.path(ROOT_DIR2, \"230329_rnaAugmented_seurat.RDS\"))"},{"path":"https://furlan-lab.github.io/viewmastR/articles/HowTo.html","id":"defining-ground-truth-in-the-query-dataset","dir":"Articles","previous_headings":"","what":"Defining “Ground Truth” in the Query Dataset","title":"How to use viewmastR","text":"Although don’t know cell type labels query dataset priori, can approximate ground truth using cluster-based cell type assignments. approximation help us evaluate accuracy viewmastR’s predictions. can visualize query dataset ground truth labels get initial idea cell types ’re working .","code":"DimPlot(seu, group.by = \"ground_truth\", cols = seur@misc$colors)"},{"path":"https://furlan-lab.github.io/viewmastR/articles/HowTo.html","id":"finding-common-features","dir":"Articles","previous_headings":"","what":"Finding Common Features","title":"How to use viewmastR","text":"performance viewmastR enhanced features (genes) consistent query reference datasets. ’ll now identify select highly variable genes datasets find common genes use training model.","code":"# Calculate and plot gene dispersion in query dataset seu <- calculate_gene_dispersion(seu) plot_gene_dispersion(seu) seu <- select_genes(seu, top_n = 10000, logmean_ul = -1, logmean_ll = -8) plot_gene_dispersion(seu) vgq <- get_selected_genes(seu)  # Repeat the process for the reference dataset seur <- calculate_gene_dispersion(seur) plot_gene_dispersion(seur) seur <- select_genes(seur, top_n = 10000, logmean_ul = -1, logmean_ll = -8) plot_gene_dispersion(seur) vgr <- get_selected_genes(seur)  # Find common genes vg <- intersect(vgq, vgr)"},{"path":"https://furlan-lab.github.io/viewmastR/articles/HowTo.html","id":"visualizing-reference-cell-types","dir":"Articles","previous_headings":"","what":"Visualizing Reference Cell Types","title":"How to use viewmastR","text":"Next, visualize reference dataset see known cell type classifications viewmastR use train model.","code":"DimPlot(seur, group.by = \"SFClassification\", cols = seur@misc$colors)"},{"path":"https://furlan-lab.github.io/viewmastR/articles/HowTo.html","id":"running-viewmastr-1","dir":"Articles","previous_headings":"","what":"Running viewmastR","title":"How to use viewmastR","text":"Now run viewmastR predict cell types query dataset. function learn reference dataset’s cell type annotations apply knowledge classify query cells.","code":"seu <- viewmastR(seu, seur, ref_celldata_col = \"SFClassification\", selected_genes = vg, max_epochs = 4)"},{"path":"https://furlan-lab.github.io/viewmastR/articles/HowTo.html","id":"visualizing-predictions","dir":"Articles","previous_headings":"","what":"Visualizing Predictions","title":"How to use viewmastR","text":"running viewmastR, can visualize predicted cell types query dataset.","code":"DimPlot(seu, group.by = \"viewmastR_pred\", cols = seur@misc$colors)"},{"path":"https://furlan-lab.github.io/viewmastR/articles/HowTo.html","id":"evaluating-model-accuracy-with-a-confusion-matrix","dir":"Articles","previous_headings":"","what":"Evaluating Model Accuracy with a Confusion Matrix","title":"How to use viewmastR","text":"can evaluate accuracy viewmastR’s predictions comparing ground truth labels (approximated earlier) using confusion matrix.","code":"confusion_matrix(pred = factor(seu$viewmastR_pred), gt = factor(seu$ground_truth), cols = seur@misc$colors)"},{"path":"https://furlan-lab.github.io/viewmastR/articles/HowTo.html","id":"analyzing-training-performance","dir":"Articles","previous_headings":"","what":"Analyzing Training Performance","title":"How to use viewmastR","text":"ViewmastR can also return detailed training history, including metrics like training loss validation loss time. helps diagnose overfitting underfitting model training. access metrics, need set return_type parameter \"list\". ’s example retrieve plot training data: can now visualize training validation losses change epochs. training loss keeps decreasing validation loss plateaus increases, may indicate overfitting.","code":"# Run viewmastR with return_type = \"list\" output_list <- viewmastR(seu, seur, ref_celldata_col = \"SFClassification\", selected_genes = vg, return_type = \"list\")  # Plot training data plot_training_data(output_list) plt <- plot_training_data(output_list) plt"},{"path":"https://furlan-lab.github.io/viewmastR/articles/HowTo.html","id":"probabilities","dir":"Articles","previous_headings":"","what":"Probabilities","title":"How to use viewmastR","text":"Finally, can also look prediction probabilities using return_probs argument. add meta-data columns object prefixed string “probs_” class prediction. values transformed log-odds model prediction transformed using plogis function R.","code":"seu <- viewmastR(seu, seur, ref_celldata_col = \"SFClassification\", selected_genes = vg, backend = \"candle\", max_epochs = 4, return_probs = T) FeaturePlot_scCustom(seu, features = \"prob_14_B\") FeaturePlot_scCustom(seu, features = \"prob_16_CD8.N\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/HowTo.html","id":"appendix","dir":"Articles","previous_headings":"","what":"Appendix","title":"How to use viewmastR","text":"","code":"sessionInfo() ## R version 4.3.1 (2023-06-16) ## Platform: x86_64-apple-darwin20 (64-bit) ## Running under: macOS Sonoma 14.6.1 ##  ## Matrix products: default ## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/Los_Angeles ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] scCustomize_2.1.2  ggplot2_3.5.0      Seurat_5.0.3       SeuratObject_5.0.1 ## [5] sp_2.1-3           viewmastR_0.2.3    ##  ## loaded via a namespace (and not attached): ##   [1] fs_1.6.3                    matrixStats_1.2.0           ##   [3] spatstat.sparse_3.0-3       bitops_1.0-7                ##   [5] RcppMsgPack_0.2.3           lubridate_1.9.3             ##   [7] httr_1.4.7                  RColorBrewer_1.1-3          ##   [9] doParallel_1.0.17           tools_4.3.1                 ##  [11] sctransform_0.4.1           backports_1.4.1             ##  [13] utf8_1.2.4                  R6_2.5.1                    ##  [15] lazyeval_0.2.2              uwot_0.1.16                 ##  [17] GetoptLong_1.0.5            withr_3.0.0                 ##  [19] gridExtra_2.3               progressr_0.14.0            ##  [21] cli_3.6.2                   Biobase_2.60.0              ##  [23] textshaping_0.3.7           Cairo_1.6-2                 ##  [25] spatstat.explore_3.2-6      fastDummies_1.7.3           ##  [27] labeling_0.4.3              sass_0.4.9                  ##  [29] spatstat.data_3.0-4         proxy_0.4-27                ##  [31] ggridges_0.5.6              pbapply_1.7-2               ##  [33] pkgdown_2.0.7               systemfonts_1.0.6           ##  [35] foreign_0.8-86              parallelly_1.37.1           ##  [37] rstudioapi_0.15.0           generics_0.1.3              ##  [39] shape_1.4.6.1               crosstalk_1.2.1             ##  [41] ica_1.0-3                   spatstat.random_3.2-3       ##  [43] dplyr_1.1.4                 Matrix_1.6-5                ##  [45] ggbeeswarm_0.7.2            fansi_1.0.6                 ##  [47] S4Vectors_0.38.2            abind_1.4-5                 ##  [49] lifecycle_1.0.4             yaml_2.3.8                  ##  [51] snakecase_0.11.1            SummarizedExperiment_1.30.2 ##  [53] recipes_1.0.10              Rtsne_0.17                  ##  [55] paletteer_1.6.0             grid_4.3.1                  ##  [57] promises_1.2.1              crayon_1.5.2                ##  [59] miniUI_0.1.1.1              lattice_0.22-5              ##  [61] cowplot_1.1.3               pillar_1.9.0                ##  [63] knitr_1.45                  ComplexHeatmap_2.16.0       ##  [65] GenomicRanges_1.52.1        rjson_0.2.21                ##  [67] boot_1.3-28.1               future.apply_1.11.1         ##  [69] codetools_0.2-19            leiden_0.4.3.1              ##  [71] glue_1.7.0                  data.table_1.15.2           ##  [73] vctrs_0.6.5                 png_0.1-8                   ##  [75] spam_2.10-0                 gtable_0.3.4                ##  [77] rematch2_2.1.2              assertthat_0.2.1            ##  [79] cachem_1.0.8                gower_1.0.1                 ##  [81] xfun_0.42                   S4Arrays_1.2.0              ##  [83] mime_0.12                   prodlim_2023.08.28          ##  [85] survival_3.5-7              timeDate_4032.109           ##  [87] SingleCellExperiment_1.22.0 iterators_1.0.14            ##  [89] pbmcapply_1.5.1             hardhat_1.3.1               ##  [91] lava_1.8.0                  ellipsis_0.3.2              ##  [93] fitdistrplus_1.1-11         ROCR_1.0-11                 ##  [95] ipred_0.9-14                nlme_3.1-164                ##  [97] RcppAnnoy_0.0.22            GenomeInfoDb_1.41.1         ##  [99] bslib_0.6.1                 irlba_2.3.5.1               ## [101] vipor_0.4.7                 KernSmooth_2.23-22          ## [103] rpart_4.1.23                colorspace_2.1-0            ## [105] BiocGenerics_0.46.0         Hmisc_5.1-2                 ## [107] nnet_7.3-19                 ggrastr_1.0.2               ## [109] tidyselect_1.2.1            compiler_4.3.1              ## [111] htmlTable_2.4.2             desc_1.4.3                  ## [113] DelayedArray_0.26.7         plotly_4.10.4               ## [115] checkmate_2.3.1             scales_1.3.0                ## [117] lmtest_0.9-40               stringr_1.5.1               ## [119] digest_0.6.35               goftest_1.2-3               ## [121] spatstat.utils_3.1-0        minqa_1.2.6                 ## [123] rmarkdown_2.26              XVector_0.40.0              ## [125] htmltools_0.5.7             pkgconfig_2.0.3             ## [127] base64enc_0.1-3             lme4_1.1-35.1               ## [129] sparseMatrixStats_1.12.2    MatrixGenerics_1.12.3       ## [131] highr_0.10                  fastmap_1.1.1               ## [133] rlang_1.1.3                 GlobalOptions_0.1.2         ## [135] htmlwidgets_1.6.4           UCSC.utils_1.1.0            ## [137] shiny_1.8.0                 DelayedMatrixStats_1.22.6   ## [139] farver_2.1.1                jquerylib_0.1.4             ## [141] zoo_1.8-12                  jsonlite_1.8.8              ## [143] ModelMetrics_1.2.2.2        RCurl_1.98-1.14             ## [145] magrittr_2.0.3              Formula_1.2-5               ## [147] GenomeInfoDbData_1.2.10     dotCall64_1.1-1             ## [149] patchwork_1.2.0             munsell_0.5.0               ## [151] Rcpp_1.0.12                 reticulate_1.35.0           ## [153] stringi_1.8.3               pROC_1.18.5                 ## [155] zlibbioc_1.46.0             MASS_7.3-60.0.1             ## [157] plyr_1.8.9                  parallel_4.3.1              ## [159] listenv_0.9.1               ggrepel_0.9.5               ## [161] forcats_1.0.0               deldir_2.0-4                ## [163] splines_4.3.1               tensor_1.5                  ## [165] circlize_0.4.16             igraph_2.0.3                ## [167] spatstat.geom_3.2-9         RcppHNSW_0.6.0              ## [169] reshape2_1.4.4              stats4_4.3.1                ## [171] evaluate_0.23               ggprism_1.0.4               ## [173] nloptr_2.0.3                foreach_1.5.2               ## [175] httpuv_1.6.14               RANN_2.6.1                  ## [177] tidyr_1.3.1                 purrr_1.0.2                 ## [179] polyclip_1.10-6             future_1.33.1               ## [181] clue_0.3-65                 scattermore_1.2             ## [183] janitor_2.2.0               xtable_1.8-4                ## [185] monocle3_1.4.3              e1071_1.7-14                ## [187] RSpectra_0.16-1             later_1.3.2                 ## [189] viridisLite_0.4.2           class_7.3-22                ## [191] ragg_1.3.0                  tibble_3.2.1                ## [193] memoise_2.0.1               beeswarm_0.4.0              ## [195] IRanges_2.34.1              cluster_2.1.6               ## [197] timechange_0.3.0            globals_0.16.3              ## [199] caret_6.0-94 getwd() ## [1] \"/Users/sfurlan/develop/viewmastR/vignettes\""},{"path":"https://furlan-lab.github.io/viewmastR/articles/InDepth.html","id":"a-deeper-look-at-viewmastr","dir":"Articles","previous_headings":"","what":"A Deeper Look at viewmastR","title":"A deeper look at viewmastR","text":"diving viewmastR works, let’s first set necessary environment go essential functions streamline training analysis workflow.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/articles/InDepth.html","id":"installing-rust","dir":"Articles","previous_headings":"A Deeper Look at viewmastR","what":"1. Installing Rust","title":"A deeper look at viewmastR","text":"using viewmastR, ’ll need updated installation Rust, ’s core dependency. Follow instructions official Rust installation page set Rust system.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/articles/InDepth.html","id":"installing-viewmastr","dir":"Articles","previous_headings":"A Deeper Look at viewmastR","what":"2. Installing viewmastR","title":"A deeper look at viewmastR","text":"Rust installed, can install viewmastR directly GitHub. Ensure devtools package installed, use following command:","code":"devtools::install_github(\"furlan-lab/viewmastR\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/InDepth.html","id":"viewing-the-training-history","dir":"Articles","previous_headings":"A Deeper Look at viewmastR","what":"3. Viewing the Training History","title":"A deeper look at viewmastR","text":"viewmastR tracks key data training process, can accessed setting return_type parameter \"list\". returns: 1. query object predicted cell types. 2. training results. ’s can retrieve visualize training data:","code":"suppressPackageStartupMessages({   library(viewmastR)   library(Seurat)   library(ggplot2)   library(scCustomize)   library(plotly) })  # Load query and reference datasets seu <- readRDS(file.path(ROOT_DIR1, \"240813_final_object.RDS\")) vg <- get_selected_genes(seu) seur <- readRDS(file.path(ROOT_DIR2, \"230329_rnaAugmented_seurat.RDS\"))  # View training history output_list <- viewmastR(seu, seur, ref_celldata_col = \"SFClassification\", selected_genes = vg, return_type = \"list\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/InDepth.html","id":"visualizing-training-data","dir":"Articles","previous_headings":"A Deeper Look at viewmastR > 3. Viewing the Training History","what":"Visualizing Training Data","title":"A deeper look at viewmastR","text":"plot training vs validation loss, can use following: rendering plot without details: Tip: training loss decreases validation loss plateaus, may indicate overfitting.","code":"plot_training_data(output_list) plt <- plot_training_data(output_list) plt"},{"path":"https://furlan-lab.github.io/viewmastR/articles/InDepth.html","id":"tuning-for-speed","dir":"Articles","previous_headings":"A Deeper Look at viewmastR","what":"4. Tuning for Speed","title":"A deeper look at viewmastR","text":"viewmastR runs 3 available backends (see Burn details). candle backend tends run faster Apple M1/M2 processors. ’s can compare performance different backends system:","code":"run1 <- viewmastR(seu, seur, ref_celldata_col = \"SFClassification\", selected_genes = vg, max_epochs = 3, backend = \"candle\", return_type = \"list\") run2 <- viewmastR(seu, seur, ref_celldata_col = \"SFClassification\", selected_genes = vg, max_epochs = 3, backend = \"wgpu\", return_type = \"list\") run3 <- viewmastR(seu, seur, ref_celldata_col = \"SFClassification\", selected_genes = vg, max_epochs = 3, backend = \"nd\", return_type = \"list\")  # Compare training times gp<-ggplot(data.frame(training_times = c(run1$training_output$duration$training_duration,                                     run2$training_output$duration$training_duration,                                     run3$training_output$duration$training_duration),                    backend = c(\"candle\", \"wgpu\", \"nd\")),        aes(x = backend, y = training_times, fill = backend)) +    geom_col() +    theme_bw() +    labs(x = \"Backend\", y = \"Training Time (s)\") +    NoLegend() + ggtitle(paste(\"Arch: \", as.character(Sys.info()[\"machine\"])))    ggplotly(gp) # To automatically set backend  if (as.character(Sys.info()[\"machine\"])==\"x86_64\"){   backend <- \"wgpu\" } else {   backend <- \"candle\" }"},{"path":"https://furlan-lab.github.io/viewmastR/articles/InDepth.html","id":"saving-training-subsets","dir":"Articles","previous_headings":"A Deeper Look at viewmastR","what":"5. Saving Training Subsets","title":"A deeper look at viewmastR","text":"inspect training test data used viewmastR provide setup_training function desire evaluate using learning frameworks.","code":"ti <- setup_training(seu, seur, ref_celldata_col = \"SFClassification\", selected_genes = vg, return_type = \"matrix\", backend = backend)  # Convert labels to max class and save them train_label <- apply(ti$Ytrain_label, 1, which.max) test_label <- apply(ti$Ytest_label, 1, which.max)  # Save training data and labels writeMMgz(as(ti$Xtrain_data, \"dgCMatrix\"), \"/path/to/train.mm.gz\") writeMMgz(as(ti$Xtest_data, \"dgCMatrix\"), \"/path/to/test.mm.gz\") writeMMgz(as(ti$query, \"dgCMatrix\"), \"/path/to/query.mm.gz\") data.table::fwrite(data.frame(train = train_label), \"/path/to/train_labels.tsv.gz\", compress = \"gzip\") data.table::fwrite(data.frame(test = test_label), \"/path/to/test_labels.tsv.gz\", compress = \"gzip\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/InDepth.html","id":"analyzing-probabilities","dir":"Articles","previous_headings":"A Deeper Look at viewmastR","what":"6. Analyzing Probabilities","title":"A deeper look at viewmastR","text":"Run inference obtain prediction probabilities:","code":"ti <- setup_training(seu, seur, ref_celldata_col = \"SFClassification\", selected_genes = vg, return_type = \"matrix\") seu <- viewmastR(seu, seur, ref_celldata_col = \"SFClassification\", selected_genes = vg, max_epochs = 3, backend = backend)  # Obtain prediction probabilities seu <- viewmastR_infer(seu, \"/tmp/sc_local/model.mpk\", vg, labels = levels(factor(seur$SFClassification)), return_probs = TRUE) scCustomize::FeaturePlot_scCustom(seu, features = \"prob_19_CD8.EM\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/InDepth.html","id":"evaluating-model-weights","dir":"Articles","previous_headings":"A Deeper Look at viewmastR","what":"7. Evaluating Model Weights","title":"A deeper look at viewmastR","text":"inspect model weights (note works mlr - see ):","code":"mod <- RcppMsgPack::msgpack_read(\"/tmp/sc_local/model.mpk\", simplify = TRUE) weights <- mod$item$linear1$weight$param$value shape <- mod$item$linear1$weight$param$shape wmat <- data.frame(t(matrix(weights, nrow = shape[2]))) rownames(wmat) <- ti$features colnames(wmat) <- ti$label_text top_NK_genes <- rownames(wmat)[sort(wmat$'21_NK', index.return=T, decreasing=T)$ix[1:20]] seu <-AddModuleScore(seu, features = list(top_nk_genes=top_NK_genes)) FeaturePlot_scCustom(seu, features = \"Cluster1\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/InDepth.html","id":"comparing-different-algorithms","dir":"Articles","previous_headings":"A Deeper Look at viewmastR","what":"8. Comparing Different Algorithms","title":"A deeper look at viewmastR","text":"viewmastR supports various algorithms, pseudo multinomial logistic regression (mlr), multinomial naive bayes (nb), multi-layer perceptron (nn). Note mlr function neural network hidden layers using ReLu activation. can read similarity simple neural network logistic regression (https://medium.com/@axegggl/neural-networks-decoded--logistic-regression---hidden-first-step-495f4a0b5fd#:~:text=%20you%20think%20about%20a,like%20a%20logistic%20regression%20model.) code shows can run compare methods:","code":"seu <- viewmastR(seu, seur, ref_celldata_col = \"SFClassification\", FUNC = \"mlr\", query_celldata_col = \"mlr_pred\", selected_genes = vg, backend = backend) seu <- viewmastR(seu, seur, ref_celldata_col = \"SFClassification\", FUNC = \"nb\", query_celldata_col = \"nb_pred\", selected_genes = vg, backend = backend) seu <- viewmastR(seu, seur, ref_celldata_col = \"SFClassification\", FUNC = \"nn\", query_celldata_col = \"nn_pred\", selected_genes = vg, hidden_layers = c(200), backend = backend)  # Visualize predictions DimPlot(seu, group.by = \"mlr_pred\") DimPlot(seu, group.by = \"nb_pred\") DimPlot(seu, group.by = \"nn_pred\") # Evaluate accuracy accuracy_mlr <- length(which(seu$mlr_pred == seu$ground_truth)) / dim(seu)[2] accuracy_nb <- length(which(seu$nb_pred == seu$ground_truth)) / dim(seu)[2] accuracy_nn <- length(which(seu$nn_pred == seu$ground_truth)) / dim(seu)[2]  # Compare accuracies gp<-ggplot(data.frame(accuracy = c(accuracy_mlr, accuracy_nb, accuracy_nn)*100,                    algorithm = c(\"mlr\", \"nb\", \"nn\")),        aes(x = algorithm, y = accuracy, fill = algorithm)) +    geom_col() +    theme_bw() +    labs(x = \"Algorithm\", y = \"Accuracy (%)\") +    NoLegend() ggplotly(gp)"},{"path":"https://furlan-lab.github.io/viewmastR/articles/InDepth.html","id":"appendix-session-information","dir":"Articles","previous_headings":"A Deeper Look at viewmastR","what":"Appendix: Session Information","title":"A deeper look at viewmastR","text":"ensure reproducibility, ’s can capture session information:","code":"sessionInfo() ## R version 4.3.1 (2023-06-16) ## Platform: x86_64-apple-darwin20 (64-bit) ## Running under: macOS Sonoma 14.6.1 ##  ## Matrix products: default ## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/Los_Angeles ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] plotly_4.10.4      scCustomize_2.1.2  ggplot2_3.5.0      Seurat_5.0.3       ## [5] SeuratObject_5.0.1 sp_2.1-3           viewmastR_0.2.3    ##  ## loaded via a namespace (and not attached): ##   [1] fs_1.6.3                    matrixStats_1.2.0           ##   [3] spatstat.sparse_3.0-3       bitops_1.0-7                ##   [5] RcppMsgPack_0.2.3           lubridate_1.9.3             ##   [7] httr_1.4.7                  RColorBrewer_1.1-3          ##   [9] doParallel_1.0.17           tools_4.3.1                 ##  [11] sctransform_0.4.1           backports_1.4.1             ##  [13] utf8_1.2.4                  R6_2.5.1                    ##  [15] lazyeval_0.2.2              uwot_0.1.16                 ##  [17] GetoptLong_1.0.5            withr_3.0.0                 ##  [19] gridExtra_2.3               progressr_0.14.0            ##  [21] cli_3.6.2                   Biobase_2.60.0              ##  [23] textshaping_0.3.7           spatstat.explore_3.2-6      ##  [25] fastDummies_1.7.3           labeling_0.4.3              ##  [27] sass_0.4.9                  spatstat.data_3.0-4         ##  [29] ggridges_0.5.6              pbapply_1.7-2               ##  [31] pkgdown_2.0.7               systemfonts_1.0.6           ##  [33] foreign_0.8-86              parallelly_1.37.1           ##  [35] rstudioapi_0.15.0           generics_0.1.3              ##  [37] shape_1.4.6.1               crosstalk_1.2.1             ##  [39] ica_1.0-3                   spatstat.random_3.2-3       ##  [41] dplyr_1.1.4                 Matrix_1.6-5                ##  [43] ggbeeswarm_0.7.2            fansi_1.0.6                 ##  [45] S4Vectors_0.38.2            abind_1.4-5                 ##  [47] lifecycle_1.0.4             yaml_2.3.8                  ##  [49] snakecase_0.11.1            SummarizedExperiment_1.30.2 ##  [51] recipes_1.0.10              Rtsne_0.17                  ##  [53] paletteer_1.6.0             grid_4.3.1                  ##  [55] promises_1.2.1              crayon_1.5.2                ##  [57] miniUI_0.1.1.1              lattice_0.22-5              ##  [59] cowplot_1.1.3               pillar_1.9.0                ##  [61] knitr_1.45                  ComplexHeatmap_2.16.0       ##  [63] GenomicRanges_1.52.1        rjson_0.2.21                ##  [65] boot_1.3-28.1               future.apply_1.11.1         ##  [67] codetools_0.2-19            leiden_0.4.3.1              ##  [69] glue_1.7.0                  data.table_1.15.2           ##  [71] vctrs_0.6.5                 png_0.1-8                   ##  [73] spam_2.10-0                 gtable_0.3.4                ##  [75] rematch2_2.1.2              assertthat_0.2.1            ##  [77] cachem_1.0.8                gower_1.0.1                 ##  [79] xfun_0.42                   S4Arrays_1.2.0              ##  [81] mime_0.12                   prodlim_2023.08.28          ##  [83] survival_3.5-7              timeDate_4032.109           ##  [85] SingleCellExperiment_1.22.0 iterators_1.0.14            ##  [87] pbmcapply_1.5.1             hardhat_1.3.1               ##  [89] lava_1.8.0                  ellipsis_0.3.2              ##  [91] fitdistrplus_1.1-11         ROCR_1.0-11                 ##  [93] ipred_0.9-14                nlme_3.1-164                ##  [95] RcppAnnoy_0.0.22            GenomeInfoDb_1.41.1         ##  [97] bslib_0.6.1                 irlba_2.3.5.1               ##  [99] vipor_0.4.7                 KernSmooth_2.23-22          ## [101] rpart_4.1.23                colorspace_2.1-0            ## [103] BiocGenerics_0.46.0         Hmisc_5.1-2                 ## [105] nnet_7.3-19                 ggrastr_1.0.2               ## [107] tidyselect_1.2.1            compiler_4.3.1              ## [109] htmlTable_2.4.2             desc_1.4.3                  ## [111] DelayedArray_0.26.7         checkmate_2.3.1             ## [113] scales_1.3.0                lmtest_0.9-40               ## [115] stringr_1.5.1               digest_0.6.35               ## [117] goftest_1.2-3               spatstat.utils_3.1-0        ## [119] minqa_1.2.6                 rmarkdown_2.26              ## [121] XVector_0.40.0              htmltools_0.5.7             ## [123] pkgconfig_2.0.3             base64enc_0.1-3             ## [125] lme4_1.1-35.1               sparseMatrixStats_1.12.2    ## [127] MatrixGenerics_1.12.3       highr_0.10                  ## [129] fastmap_1.1.1               rlang_1.1.3                 ## [131] GlobalOptions_0.1.2         htmlwidgets_1.6.4           ## [133] UCSC.utils_1.1.0            shiny_1.8.0                 ## [135] DelayedMatrixStats_1.22.6   farver_2.1.1                ## [137] jquerylib_0.1.4             zoo_1.8-12                  ## [139] jsonlite_1.8.8              ModelMetrics_1.2.2.2        ## [141] RCurl_1.98-1.14             magrittr_2.0.3              ## [143] Formula_1.2-5               GenomeInfoDbData_1.2.10     ## [145] dotCall64_1.1-1             patchwork_1.2.0             ## [147] munsell_0.5.0               Rcpp_1.0.12                 ## [149] reticulate_1.35.0           stringi_1.8.3               ## [151] pROC_1.18.5                 zlibbioc_1.46.0             ## [153] MASS_7.3-60.0.1             plyr_1.8.9                  ## [155] parallel_4.3.1              listenv_0.9.1               ## [157] ggrepel_0.9.5               forcats_1.0.0               ## [159] deldir_2.0-4                splines_4.3.1               ## [161] tensor_1.5                  circlize_0.4.16             ## [163] igraph_2.0.3                spatstat.geom_3.2-9         ## [165] RcppHNSW_0.6.0              reshape2_1.4.4              ## [167] stats4_4.3.1                evaluate_0.23               ## [169] ggprism_1.0.4               nloptr_2.0.3                ## [171] foreach_1.5.2               httpuv_1.6.14               ## [173] RANN_2.6.1                  tidyr_1.3.1                 ## [175] purrr_1.0.2                 polyclip_1.10-6             ## [177] future_1.33.1               clue_0.3-65                 ## [179] scattermore_1.2             janitor_2.2.0               ## [181] xtable_1.8-4                monocle3_1.4.3              ## [183] RSpectra_0.16-1             later_1.3.2                 ## [185] viridisLite_0.4.2           class_7.3-22                ## [187] ragg_1.3.0                  tibble_3.2.1                ## [189] memoise_2.0.1               beeswarm_0.4.0              ## [191] IRanges_2.34.1              cluster_2.1.6               ## [193] timechange_0.3.0            globals_0.16.3              ## [195] caret_6.0-94 getwd() ## [1] \"/Users/sfurlan/develop/viewmastR/vignettes\""},{"path":"https://furlan-lab.github.io/viewmastR/articles/SavedModel.html","id":"installing-rust","dir":"Articles","previous_headings":"","what":"Installing Rust","title":"How to use viewmastR with saved models","text":"First need updated Rust installation. Go site learn install Rust.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/articles/SavedModel.html","id":"installing-viewmastr","dir":"Articles","previous_headings":"","what":"Installing viewmastR","title":"How to use viewmastR with saved models","text":"need devtools package installed…","code":"devtools::install_github(\"furlan-lab/viewmastR\")"},{"path":"https://furlan-lab.github.io/viewmastR/articles/SavedModel.html","id":"running-viewmastr","dir":"Articles","previous_headings":"","what":"Running viewmastR","title":"How to use viewmastR with saved models","text":"","code":"suppressPackageStartupMessages({ library(viewmastR) library(Seurat) library(ggplot2) })  #query dataset seu <- readRDS(file.path(ROOT_DIR1, \"240813_final_object.RDS\")) #reference dataset seur<-readRDS(file.path(ROOT_DIR2, \"230329_rnaAugmented_seurat.RDS\")) vg <- get_selected_genes(seu)"},{"path":"https://furlan-lab.github.io/viewmastR/articles/SavedModel.html","id":"now-you-run-viewmastr","dir":"Articles","previous_headings":"","what":"Now you run viewmastR","title":"How to use viewmastR with saved models","text":"model path specified using ‘dir’ argument","code":"seu<-viewmastR(seu, seur, ref_celldata_col = \"SFClassification\", selected_genes = vg, dir = \"/tmp/sc_local\", max_epochs = 3)"},{"path":"https://furlan-lab.github.io/viewmastR/articles/SavedModel.html","id":"a-look-at-the-predictions","dir":"Articles","previous_headings":"","what":"A look at the predictions","title":"How to use viewmastR with saved models","text":"","code":"DimPlot(seu, group.by = \"viewmastR_pred\", cols = seur@misc$colors)"},{"path":"https://furlan-lab.github.io/viewmastR/articles/SavedModel.html","id":"run-inference","dir":"Articles","previous_headings":"","what":"Run inference","title":"How to use viewmastR with saved models","text":"can use function viewmastR_infer run inference saved model. need pass vector variable features used initially create model. can use query_celldata_col specify name metadata column returned object. optional vector labels can provided. Additionally, instead returning input object predictions added, may instead return probabilities using return_probs argument.","code":"seu<-viewmastR_infer(seu, \"/tmp/sc_local/model.mpk\", vg, labels = levels(factor(seur$SFClassification))) DimPlot(seu, group.by = \"viewmastR_inferred\", cols = seur@misc$colors)"},{"path":"https://furlan-lab.github.io/viewmastR/articles/SavedModel.html","id":"a-confusion-matrix-comparing-the-results-using-viewmastr-to-viewmastr_infer-having-saved-the-model-to-disc-","dir":"Articles","previous_headings":"","what":"A confusion matrix comparing the results using viewmastR to viewmastR_infer having saved the model to disc.","title":"How to use viewmastR with saved models","text":"Open question small number cells different :)","code":"confusion_matrix(pred = factor(seu$viewmastR_inferred), gt = factor(seu$viewmastR_pred), cols = seur@misc$colors)"},{"path":"https://furlan-lab.github.io/viewmastR/articles/SavedModel.html","id":"appendix","dir":"Articles","previous_headings":"","what":"Appendix","title":"How to use viewmastR with saved models","text":"","code":"sessionInfo() ## R version 4.3.1 (2023-06-16) ## Platform: x86_64-apple-darwin20 (64-bit) ## Running under: macOS Sonoma 14.6.1 ##  ## Matrix products: default ## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/Los_Angeles ## tzcode source: internal ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] ggplot2_3.5.0      Seurat_5.0.3       SeuratObject_5.0.1 sp_2.1-3           ## [5] viewmastR_0.2.3    ##  ## loaded via a namespace (and not attached): ##   [1] fs_1.6.3                    matrixStats_1.2.0           ##   [3] spatstat.sparse_3.0-3       bitops_1.0-7                ##   [5] RcppMsgPack_0.2.3           lubridate_1.9.3             ##   [7] httr_1.4.7                  RColorBrewer_1.1-3          ##   [9] doParallel_1.0.17           tools_4.3.1                 ##  [11] sctransform_0.4.1           backports_1.4.1             ##  [13] utf8_1.2.4                  R6_2.5.1                    ##  [15] lazyeval_0.2.2              uwot_0.1.16                 ##  [17] GetoptLong_1.0.5            withr_3.0.0                 ##  [19] gridExtra_2.3               scCustomize_2.1.2           ##  [21] progressr_0.14.0            cli_3.6.2                   ##  [23] Biobase_2.60.0              textshaping_0.3.7           ##  [25] Cairo_1.6-2                 spatstat.explore_3.2-6      ##  [27] fastDummies_1.7.3           labeling_0.4.3              ##  [29] sass_0.4.9                  spatstat.data_3.0-4         ##  [31] proxy_0.4-27                ggridges_0.5.6              ##  [33] pbapply_1.7-2               pkgdown_2.0.7               ##  [35] systemfonts_1.0.6           foreign_0.8-86              ##  [37] parallelly_1.37.1           rstudioapi_0.15.0           ##  [39] generics_0.1.3              shape_1.4.6.1               ##  [41] ica_1.0-3                   spatstat.random_3.2-3       ##  [43] dplyr_1.1.4                 Matrix_1.6-5                ##  [45] ggbeeswarm_0.7.2            fansi_1.0.6                 ##  [47] S4Vectors_0.38.2            abind_1.4-5                 ##  [49] lifecycle_1.0.4             yaml_2.3.8                  ##  [51] snakecase_0.11.1            SummarizedExperiment_1.30.2 ##  [53] recipes_1.0.10              Rtsne_0.17                  ##  [55] paletteer_1.6.0             grid_4.3.1                  ##  [57] promises_1.2.1              crayon_1.5.2                ##  [59] miniUI_0.1.1.1              lattice_0.22-5              ##  [61] cowplot_1.1.3               pillar_1.9.0                ##  [63] knitr_1.45                  ComplexHeatmap_2.16.0       ##  [65] GenomicRanges_1.52.1        rjson_0.2.21                ##  [67] boot_1.3-28.1               future.apply_1.11.1         ##  [69] codetools_0.2-19            leiden_0.4.3.1              ##  [71] glue_1.7.0                  data.table_1.15.2           ##  [73] vctrs_0.6.5                 png_0.1-8                   ##  [75] spam_2.10-0                 gtable_0.3.4                ##  [77] rematch2_2.1.2              assertthat_0.2.1            ##  [79] cachem_1.0.8                gower_1.0.1                 ##  [81] xfun_0.42                   S4Arrays_1.2.0              ##  [83] mime_0.12                   prodlim_2023.08.28          ##  [85] survival_3.5-7              timeDate_4032.109           ##  [87] SingleCellExperiment_1.22.0 iterators_1.0.14            ##  [89] pbmcapply_1.5.1             hardhat_1.3.1               ##  [91] lava_1.8.0                  ellipsis_0.3.2              ##  [93] fitdistrplus_1.1-11         ROCR_1.0-11                 ##  [95] ipred_0.9-14                nlme_3.1-164                ##  [97] RcppAnnoy_0.0.22            GenomeInfoDb_1.41.1         ##  [99] bslib_0.6.1                 irlba_2.3.5.1               ## [101] vipor_0.4.7                 KernSmooth_2.23-22          ## [103] rpart_4.1.23                colorspace_2.1-0            ## [105] BiocGenerics_0.46.0         Hmisc_5.1-2                 ## [107] nnet_7.3-19                 ggrastr_1.0.2               ## [109] tidyselect_1.2.1            compiler_4.3.1              ## [111] htmlTable_2.4.2             desc_1.4.3                  ## [113] DelayedArray_0.26.7         plotly_4.10.4               ## [115] checkmate_2.3.1             scales_1.3.0                ## [117] lmtest_0.9-40               stringr_1.5.1               ## [119] digest_0.6.35               goftest_1.2-3               ## [121] spatstat.utils_3.1-0        minqa_1.2.6                 ## [123] rmarkdown_2.26              XVector_0.40.0              ## [125] htmltools_0.5.7             pkgconfig_2.0.3             ## [127] base64enc_0.1-3             lme4_1.1-35.1               ## [129] sparseMatrixStats_1.12.2    MatrixGenerics_1.12.3       ## [131] highr_0.10                  fastmap_1.1.1               ## [133] rlang_1.1.3                 GlobalOptions_0.1.2         ## [135] htmlwidgets_1.6.4           UCSC.utils_1.1.0            ## [137] shiny_1.8.0                 DelayedMatrixStats_1.22.6   ## [139] farver_2.1.1                jquerylib_0.1.4             ## [141] zoo_1.8-12                  jsonlite_1.8.8              ## [143] ModelMetrics_1.2.2.2        RCurl_1.98-1.14             ## [145] magrittr_2.0.3              Formula_1.2-5               ## [147] GenomeInfoDbData_1.2.10     dotCall64_1.1-1             ## [149] patchwork_1.2.0             munsell_0.5.0               ## [151] Rcpp_1.0.12                 reticulate_1.35.0           ## [153] stringi_1.8.3               pROC_1.18.5                 ## [155] zlibbioc_1.46.0             MASS_7.3-60.0.1             ## [157] plyr_1.8.9                  parallel_4.3.1              ## [159] listenv_0.9.1               ggrepel_0.9.5               ## [161] forcats_1.0.0               deldir_2.0-4                ## [163] splines_4.3.1               tensor_1.5                  ## [165] circlize_0.4.16             igraph_2.0.3                ## [167] spatstat.geom_3.2-9         RcppHNSW_0.6.0              ## [169] reshape2_1.4.4              stats4_4.3.1                ## [171] evaluate_0.23               ggprism_1.0.4               ## [173] nloptr_2.0.3                foreach_1.5.2               ## [175] httpuv_1.6.14               RANN_2.6.1                  ## [177] tidyr_1.3.1                 purrr_1.0.2                 ## [179] polyclip_1.10-6             future_1.33.1               ## [181] clue_0.3-65                 scattermore_1.2             ## [183] janitor_2.2.0               xtable_1.8-4                ## [185] monocle3_1.4.3              e1071_1.7-14                ## [187] RSpectra_0.16-1             later_1.3.2                 ## [189] viridisLite_0.4.2           class_7.3-22                ## [191] ragg_1.3.0                  tibble_3.2.1                ## [193] memoise_2.0.1               beeswarm_0.4.0              ## [195] IRanges_2.34.1              cluster_2.1.6               ## [197] timechange_0.3.0            globals_0.16.3              ## [199] caret_6.0-94 getwd() ## [1] \"/Users/sfurlan/develop/viewmastR/vignettes\""},{"path":"https://furlan-lab.github.io/viewmastR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Scott Furlan. Author, maintainer.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Furlan S (2024). viewmastR: Automated single-cell genomic cell type assignment. R package version 0.2.3, https://furlan-lab.github.io/viewmastR/.","code":"@Manual{,   title = {viewmastR: Automated single-cell genomic cell type assignment},   author = {Scott Furlan},   year = {2024},   note = {R package version 0.2.3},   url = {https://furlan-lab.github.io/viewmastR/}, }"},{"path":"https://furlan-lab.github.io/viewmastR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Automated single-cell genomic cell type assignment","text":"First need updated Rust installation. Go site learn install Rust. install development version viewmastR:","code":"remotes::install_github(\"furlan-lab/viewmastR\")"},{"path":"https://furlan-lab.github.io/viewmastR/index.html","id":"how-to-start","dir":"","previous_headings":"","what":"How to start","title":"Automated single-cell genomic cell type assignment","text":"vignettes vignette(\"HowTo\") explore basics package. vignette(\"Augment\") explore data augmentation vignette(\"BulkClassify\") see use bulk dataset classify single-cell profiles","code":""},{"path":"https://furlan-lab.github.io/viewmastR/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Automated single-cell genomic cell type assignment","text":"viewmastR dependency Burn, open source Rust machine learning library. viewmastR written MIT license.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/index.html","id":"acknowledgements","dir":"","previous_headings":"","what":"Acknowledgements","title":"Automated single-cell genomic cell type assignment","text":"Written Scott Furlan.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/augment_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Augment data — augment_data","title":"Augment data — augment_data","text":"function takes seurat object finds cells sufficiently abundant grouped column parameter, simulates data augment cell number level parameter - norm_number","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/augment_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Augment data — augment_data","text":"","code":"augment_data(obj, column, norm_number = 2000, assay = \"RNA\", prune = F)"},{"path":"https://furlan-lab.github.io/viewmastR/reference/augment_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Augment data — augment_data","text":"column column metadata designates cell group (.e. celltype) norm_number cell number augment data cells sufficiently abundant object prune downsample cells present number higher norm_number level norm_number (default = F)","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/augment_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Augment data — augment_data","text":"seurat object augmented simulated cells cell groups present level norm_number cells","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/calculate_gene_dispersion.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate dispersion genes in a cell_data_set object — calculate_gene_dispersion","title":"Calculate dispersion genes in a cell_data_set object — calculate_gene_dispersion","text":"Monocle3 aims learn cells transition biological program gene expression changes experiment. cell can viewed point high-dimensional space, dimension describes expression different gene. Identifying program gene expression changes equivalent learning trajectory cells follow space. However, dimensions analysis, harder trajectory learn. Fortunately, many genes typically co-vary one another, dimensionality data can reduced wide variety different algorithms. Monocle3 provides two different algorithms dimensionality reduction via reduce_dimensions (UMAP tSNE). function calculate_dispersion optional step trajectory building process preprocess_cds.  calculating dispersion cell_data_set using calculate_gene_dispersion function, select_genes function allows user identify set genes used downstream dimensionality reduction methods.  genes disperion mean expression can plotted using plot_gene_dispersion function. function calculates dispersion genes cell_data_set object downstream analysis.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/calculate_gene_dispersion.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate dispersion genes in a cell_data_set object — calculate_gene_dispersion","text":"","code":"calculate_gene_dispersion(   cds,   q = 3,   id_tag = \"id\",   symbol_tag = \"gene_short_name\",   method = \"m3addon\",   removeOutliers = T )  calculate_gene_dispersion(   cds,   q = 3,   id_tag = \"id\",   symbol_tag = \"gene_short_name\",   method = \"m3addon\",   removeOutliers = T )"},{"path":"https://furlan-lab.github.io/viewmastR/reference/calculate_gene_dispersion.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate dispersion genes in a cell_data_set object — calculate_gene_dispersion","text":"cds cell data set upon perform operation. q polynomial degree. id_tag name feature data column corresponding unique id. symbol_tag name feature data column corresponding gene symbol. upper_lim upper limit dispersion consider. verbose Boolean indicating whether display verbose output.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/calculate_gene_dispersion.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate dispersion genes in a cell_data_set object — calculate_gene_dispersion","text":"updated cell_data_set object dispersion mean expression saved vector dispersion genes.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/common_features.html","id":null,"dir":"Reference","previous_headings":"","what":"Finds common features in a list of single cell objects — common_features","title":"Finds common features in a list of single cell objects — common_features","text":"Machine learning algorithms often require features across datasets.  function finds common features list cell data set objects (monocle3) returns list cds's features.  Note function uses rownames 'fData' DataFrame (monocle3) rownames seurat_object find intersect features common objects Machine learning algorithms often require features across datasets.  function finds common features list cell data set objects (monocle3) returns list cds's features.  Note function uses rownames 'fData' DataFrame (monocle3) rownames seurat_object find intersect features common objects","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/common_features.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Finds common features in a list of single cell objects — common_features","text":"","code":"common_features(cds_list)  common_features(cds_list)"},{"path":"https://furlan-lab.github.io/viewmastR/reference/common_features.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Finds common features in a list of single cell objects — common_features","text":"cds_list Input  object.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/common_variant_genes.html","id":null,"dir":"Reference","previous_headings":"","what":"Common Variant Genes — common_variant_genes","title":"Common Variant Genes — common_variant_genes","text":"function finds common variant genes two cell data sets.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/common_variant_genes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Common Variant Genes — common_variant_genes","text":"","code":"common_variant_genes(   cds1,   cds2,   top_n = 2000,   logmean_ul = 2,   logmean_ll = -6,   row_data_column = \"gene_short_name\",   unique_data_column = \"id\",   verbose = T,   plot = F )"},{"path":"https://furlan-lab.github.io/viewmastR/reference/common_variant_genes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Common Variant Genes — common_variant_genes","text":"cds1 first cell data set. cds2 second cell data set. top_n number top genes consider. Default 2000. logmean_ul upper limit mean expression. logmean_ll lower limit mean expression. row_data_column column feature data corresponding gene symbol. unique_data_column column feature data corresponding unique id. verbose Boolean indicating whether display verbose output. plot Boolean indicating whether plot results.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/common_variant_genes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Common Variant Genes — common_variant_genes","text":"vector similarly variant genes.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/computeSparseRowVariances.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute sparse row variance — computeSparseRowVariances","title":"Compute sparse row variance — computeSparseRowVariances","text":"Compute sparse row variance","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/computeSparseRowVariances.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute sparse row variance — computeSparseRowVariances","text":"","code":"computeSparseRowVariances(j, val, rm, n)"},{"path":"https://furlan-lab.github.io/viewmastR/reference/confusion_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Confusion matrix — confusion_matrix","title":"Confusion matrix — confusion_matrix","text":"function generate confusion matrix two factors; pred (short prediction) gt (short ground truth).  One may optionally supply named vector colors annotate row column legends.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/confusion_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confusion matrix — confusion_matrix","text":"","code":"confusion_matrix(pred, gt, cols = NULL)"},{"path":"https://furlan-lab.github.io/viewmastR/reference/confusion_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confusion matrix — confusion_matrix","text":"pred factor predictions gt factor ground truth cols named vector colors","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/confusion_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confusion matrix — confusion_matrix","text":"confusion matrix plot","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/detect_genes.html","id":null,"dir":"Reference","previous_headings":"","what":"Detects genes above minimum threshold. — detect_genes","title":"Detects genes above minimum threshold. — detect_genes","text":"gene cell_data_set object, detect_genes counts many cells expressed minimum threshold. addition, cell, detect_genes counts number genes threshold detectable. Results added columns num_cells_expressed num_genes_expressed rowData colData tables respectively.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/detect_genes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detects genes above minimum threshold. — detect_genes","text":"","code":"detect_genes(cds, min_expr = 0, exprs_bin = TRUE, exprs_cuts = 25)"},{"path":"https://furlan-lab.github.io/viewmastR/reference/detect_genes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Detects genes above minimum threshold. — detect_genes","text":"cds Input cell_data_set object. min_expr Numeric indicating expression threshold exprs_bin Boolean whether bin genes mean expression exprs_cuts Numeic indicating number bins using exprs_bin","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/detect_genes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Detects genes above minimum threshold. — detect_genes","text":"Updated cell_data_set object","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/infer_from_model.html","id":null,"dir":"Reference","previous_headings":"","what":"infer from saved model — infer_from_model","title":"infer from saved model — infer_from_model","text":"infer saved model","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/infer_from_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"infer from saved model — infer_from_model","text":"","code":"infer_from_model(model_path, query, num_classes, num_features, verbose)"},{"path":"https://furlan-lab.github.io/viewmastR/reference/plot_training_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Training data plot — plot_training_data","title":"Training data plot — plot_training_data","text":"function display plot data generated viewmastR training","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/plot_training_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Training data plot — plot_training_data","text":"","code":"plot_training_data(output_list)"},{"path":"https://furlan-lab.github.io/viewmastR/reference/plot_training_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Training data plot — plot_training_data","text":"output_list list returned running viewmastR using return_type = \"list\" parameter.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/plot_training_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Training data plot — plot_training_data","text":"plot training data","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/process_learning_obj_ann.html","id":null,"dir":"Reference","previous_headings":"","what":"Process Robj learning objects for ANN — process_learning_obj_ann","title":"Process Robj learning objects for ANN — process_learning_obj_ann","text":"Process Robj learning objects ANN","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/process_learning_obj_ann.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process Robj learning objects for ANN — process_learning_obj_ann","text":"","code":"process_learning_obj_ann(   train,   test,   query,   labels,   hidden_size,   learning_rate,   num_epochs,   directory,   verbose,   backend )"},{"path":"https://furlan-lab.github.io/viewmastR/reference/process_learning_obj_mlr.html","id":null,"dir":"Reference","previous_headings":"","what":"Process Robj learning objects for MLR — process_learning_obj_mlr","title":"Process Robj learning objects for MLR — process_learning_obj_mlr","text":"Process Robj learning objects MLR","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/process_learning_obj_mlr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process Robj learning objects for MLR — process_learning_obj_mlr","text":"","code":"process_learning_obj_mlr(   train,   test,   query,   labels,   learning_rate,   num_epochs,   directory,   verbose,   backend )"},{"path":"https://furlan-lab.github.io/viewmastR/reference/process_learning_obj_nb.html","id":null,"dir":"Reference","previous_headings":"","what":"Process Robj learning objects for MLR — process_learning_obj_nb","title":"Process Robj learning objects for MLR — process_learning_obj_nb","text":"Process Robj learning objects MLR","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/process_learning_obj_nb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process Robj learning objects for MLR — process_learning_obj_nb","text":"","code":"process_learning_obj_nb(train, test, query)"},{"path":"https://furlan-lab.github.io/viewmastR/reference/readR.html","id":null,"dir":"Reference","previous_headings":"","what":"Read an R object — readR","title":"Read an R object — readR","text":"Read R object","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/readR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read an R object — readR","text":"","code":"readR(obj)"},{"path":"https://furlan-lab.github.io/viewmastR/reference/select_genes.html","id":null,"dir":"Reference","previous_headings":"","what":"Select genes in a cell_data_set for dimensionality reduction — select_genes","title":"Select genes in a cell_data_set for dimensionality reduction — select_genes","text":"Monocle3 aims learn cells transition biological program gene expression changes experiment. cell can viewed point high-dimensional space, dimension describes expression different gene. Identifying program gene expression changes equivalent learning trajectory cells follow space. However, dimensions analysis, harder trajectory learn. Fortunately, many genes typically co-vary one another, dimensionality data can reduced wide variety different algorithms. Monocle3 provides two different algorithms dimensionality reduction via reduce_dimensions (UMAP tSNE). function select_features optional step trajectory building process preprocess_cds.  calculating dispersion cell_data_set using calculate_gene_dispersion function, select_genes function allows user identify set genes used downstream dimensionality reduction methods.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/select_genes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select genes in a cell_data_set for dimensionality reduction — select_genes","text":"","code":"select_genes(   cds,   fit_min = 1,   fit_max = Inf,   logmean_ul = Inf,   logmean_ll = -Inf,   top_n = NULL )"},{"path":"https://furlan-lab.github.io/viewmastR/reference/select_genes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select genes in a cell_data_set for dimensionality reduction — select_genes","text":"cds cell_data_set upon perform operation. fit_min minimum multiple dispersion fit calculation; default = 1 fit_max maximum multiple dispersion fit calculation; default = Inf logmean_ul maximum multiple dispersion fit calculation; default = Inf logmean_ll maximum multiple dispersion fit calculation; default = Inf top top_n specified, override fit_min fit_max select top n variant features.  logmena_ul logmean_ll can still used.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/select_genes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select genes in a cell_data_set for dimensionality reduction — select_genes","text":"updated cell_data_set object selected features","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/setup_training.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup training datasets — setup_training","title":"Setup training datasets — setup_training","text":"function sets training datasets use machine learning models.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/setup_training.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup training datasets — setup_training","text":"","code":"setup_training(   query_cds,   ref_cds,   ref_celldata_col,   norm_method = c(\"log\", \"binary\", \"size_only\", \"none\"),   selected_genes = NULL,   train_frac = 0.8,   tf_idf = F,   scale = F,   LSImethod = 1,   verbose = T,   addbias = F,   return_type = c(\"list\", \"matrix\", \"S4obj\"),   debug = F,   ... )"},{"path":"https://furlan-lab.github.io/viewmastR/reference/setup_training.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup training datasets — setup_training","text":"query_cds cell data set (cds) query. ref_cds reference cell data set (cds). ref_celldata_col column reference cell data set containing cell data. norm_method normalization method use. Options \"log\", \"binary\", \"size_only\", \"none\". selected_genes vector pre-selected genes analysis. train_frac fraction data use training. tf_idf Boolean indicating whether perform TF-IDF transformation. scale Boolean indicating whether scale data. LSImethod method Latent Semantic Indexing. verbose Boolean indicating whether display verbose output. addbias Boolean indicating whether add bias. return_type type output return. Options \"list\", \"matrix\", \"S4obj\". ... Additional arguments.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/setup_training.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Setup training datasets — setup_training","text":"list, matrix, S4 object containing training datasets.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/sparseRowVariances.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function for summing sparse matrix groups — sparseRowVariances","title":"Helper function for summing sparse matrix groups — sparseRowVariances","text":"Helper function summing sparse matrix groups","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/sparseRowVariances.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function for summing sparse matrix groups — sparseRowVariances","text":"","code":"sparseRowVariances(m)"},{"path":"https://furlan-lab.github.io/viewmastR/reference/sparseRowVariances.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Helper function for summing sparse matrix groups — sparseRowVariances","text":"Granja, J. M.et al. (2019). Single-cell multiomic analysis identifies regulatory programs mixed-phenotype acute leukemia. Nature Biotechnology, 37(12), 1458–1465.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/splat_bulk_reference.html","id":null,"dir":"Reference","previous_headings":"","what":"Bulk reference — splat_bulk_reference","title":"Bulk reference — splat_bulk_reference","text":"function creates seurat object (typically single cell genomics) multiple single cell profiles sample bulk object (SummarizedExperiment object currently supported).  , function creates single cell profiles size distribution approximates provided single cell object (query)","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/splat_bulk_reference.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bulk reference — splat_bulk_reference","text":"","code":"splat_bulk_reference(   query = NULL,   ref,   N = 2,   assay = \"RNA\",   bulk_feature_row = \"gene_short_name\",   bulk_assay_name = \"counts\",   dist = c(\"sc-direct\", \"sc-mimic\", \"bulk\") )"},{"path":"https://furlan-lab.github.io/viewmastR/reference/splat_bulk_reference.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bulk reference — splat_bulk_reference","text":"query single cell object (Seurat) size distribution counts mimicked assay argument ref reference object (Summarized Experiment) assay assay slot query (Seurat) bulk_feature_row column name gene symbols ref bulk_assay_name name assay object ref dist DEVELOPMENT","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/splat_bulk_reference.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bulk reference — splat_bulk_reference","text":"classified seurat object labeled according bulk reference","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/tf_idf_transform.html","id":null,"dir":"Reference","previous_headings":"","what":"Performs TF-IDF transformation on a cell_data_set — tf_idf_transform","title":"Performs TF-IDF transformation on a cell_data_set — tf_idf_transform","text":"Just like sounds.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/tf_idf_transform.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Performs TF-IDF transformation on a cell_data_set — tf_idf_transform","text":"","code":"tf_idf_transform(input, method = 1, verbose = T)"},{"path":"https://furlan-lab.github.io/viewmastR/reference/tf_idf_transform.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Performs TF-IDF transformation on a cell_data_set — tf_idf_transform","text":"cds_list Input cell_data_set object sparse matrix.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/tf_idf_transform_v2.html","id":null,"dir":"Reference","previous_headings":"","what":"Performs TF-IDF transformation on a cell_data_set v2 — tf_idf_transform_v2","title":"Performs TF-IDF transformation on a cell_data_set v2 — tf_idf_transform_v2","text":"Just like sounds different.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/tf_idf_transform_v2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Performs TF-IDF transformation on a cell_data_set v2 — tf_idf_transform_v2","text":"","code":"tf_idf_transform_v2(input)"},{"path":"https://furlan-lab.github.io/viewmastR/reference/tf_idf_transform_v2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Performs TF-IDF transformation on a cell_data_set v2 — tf_idf_transform_v2","text":"cds_list Input cell_data_set object sparse matrix.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/viewmastR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"viewmastR: Automated single-cell genomic cell type assignment — viewmastR-package","title":"viewmastR: Automated single-cell genomic cell type assignment — viewmastR-package","text":"viewmastR uses machine learning implemented Rust perform automated cell type classification single-cell genomic data. Currently viewmastR authored work scRNAseq data, features coming.","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/viewmastR/reference/viewmastR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"viewmastR: Automated single-cell genomic cell type assignment — viewmastR-package","text":"Maintainer: Scott Furlan scottfurlan@gmail.com (ORCID)","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/viewmastR.html","id":null,"dir":"Reference","previous_headings":"","what":"Run viewmastR using the new Rust implementation — viewmastR","title":"Run viewmastR using the new Rust implementation — viewmastR","text":"function runs viewmastR using new Rust implementation generate various forms training test data given query reference cell data sets.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/viewmastR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run viewmastR using the new Rust implementation — viewmastR","text":"","code":"viewmastR(   query_cds,   ref_cds,   ref_celldata_col,   query_celldata_col = NULL,   FUNC = c(\"mlr\", \"nn\", \"nb\"),   norm_method = c(\"log\", \"binary\", \"size_only\", \"none\"),   selected_genes = NULL,   train_frac = 0.8,   tf_idf = F,   scale = F,   hidden_layers = c(500, 100),   learning_rate = 0.001,   max_epochs = 10,   LSImethod = 1,   verbose = T,   backend = c(\"wgpu\", \"nd\", \"candle\"),   threshold = NULL,   keras_model = NULL,   dir = \"/tmp/sc_local\",   return_probs = F,   return_type = c(\"object\", \"list\"),   debug = F,   ... )"},{"path":"https://furlan-lab.github.io/viewmastR/reference/viewmastR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run viewmastR using the new Rust implementation — viewmastR","text":"query_cds cell data set (cds) query. ref_cds reference cell data set (cds). ref_celldata_col column reference cell data set containing cell data. query_celldata_col column query cell data set containing cell data. Defaults \"viewmastR_pred\" provided. FUNC machine learning model use (multinomial linear regression - 'mlr' multilayer neural network - 'nn'). Default \"mlr\". norm_method normalization method use. Options \"log\", \"binary\", \"size_only\", \"none\". selected_genes vector pre-selected genes analysis. NULL, common features reference query used. train_frac fraction data use training. Default 0.8. tf_idf Boolean indicating whether perform TF-IDF transformation. Default FALSE. scale Boolean indicating whether scale data. Default FALSE. hidden_layers vector specifying number neurons hidden layers neural network models. Default c(500, 100).  use one hidden layer supply vector length 1. learning_rate learning rate training model. Default 1e-3. max_epochs maximum number epochs training model. Default 10. LSImethod method Latent Semantic Indexing. Default 1. verbose Boolean indicating whether display verbose output. Default TRUE. dir directory save output files. Default \"/tmp/sc_local\". return_type type output return. Options \"object\" \"list\". Default \"object\". debug Run debug mode ... Additional arguments.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/viewmastR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run viewmastR using the new Rust implementation — viewmastR","text":"return_type \"object\", returns modified query cell data set seurat object. return_type \"list\", returns list containing query cell data set training output.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/viewmastR_infer.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to infer cell labels using a trained model — viewmastR_infer","title":"Function to infer cell labels using a trained model — viewmastR_infer","text":"function infers cell labels using trained model updates input dataset inferred labels.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/viewmastR_infer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to infer cell labels using a trained model — viewmastR_infer","text":"","code":"viewmastR_infer(   query_cds,   model_path,   vg,   query_celldata_col = \"viewmastR_inferred\",   labels = NULL,   verbose = T,   return_probs = F )"},{"path":"https://furlan-lab.github.io/viewmastR/reference/viewmastR_infer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to infer cell labels using a trained model — viewmastR_infer","text":"query_cds Seurat cell_data_set object - dataset cell labels inferred. model_path character path trained model file. vg character vector - Features used inference (must used model creation). query_celldata_col character vector - names column store inferred cell labels query dataset. Default \"viewmastR_inferred\". labels character vector - optional labels corresponding class indices. Default NULL. verbose bool - show messaging return_probs logical TRUE, returns class probabilities. Default FALSE.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/viewmastR_infer.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to infer cell labels using a trained model — viewmastR_infer","text":"return_probs TRUE, returns data frame containing class probabilities. return_probs FALSE, updates query_cds object inferred cell labels returns .","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/writeMMgz.html","id":null,"dir":"Reference","previous_headings":"","what":"Write a compressed MatrixMarket file — writeMMgz","title":"Write a compressed MatrixMarket file — writeMMgz","text":"function writes sparse matrix MatrixMarket format compressed .gz file. function handles real integer matrix types.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/writeMMgz.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write a compressed MatrixMarket file — writeMMgz","text":"","code":"writeMMgz(x, file)"},{"path":"https://furlan-lab.github.io/viewmastR/reference/writeMMgz.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write a compressed MatrixMarket file — writeMMgz","text":"x sparse matrix (typically dgCMatrix ngCMatrix object). file character string specifying output file name, compressed .gz format.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/writeMMgz.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write a compressed MatrixMarket file — writeMMgz","text":"function return value. writes file side effect.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/writeMMgz.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Write a compressed MatrixMarket file — writeMMgz","text":"function writes matrix MatrixMarket coordinate format. first writes header indicating matrix type size, appends matrix data. matrix ngCMatrix, treated integer matrix, otherwise real matrix. function compresses output .gz file.","code":""},{"path":"https://furlan-lab.github.io/viewmastR/reference/writeMMgz.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Write a compressed MatrixMarket file — writeMMgz","text":"","code":"if (FALSE) { library(Matrix) m <- Matrix(c(0, 1, 0, 2), 2, 2, sparse = TRUE) writeMMgz(m, \"matrix.mtx.gz\") }"},{"path":"https://furlan-lab.github.io/viewmastR/news/index.html","id":"viewmastr-v023","dir":"Changelog","previous_headings":"","what":"viewmastR v0.2.3","title":"viewmastR v0.2.3","text":"new feature - naive bayes implementation new feature - make3file function easy exporting Seurat objects performance improvement - improved sparse variance function efficiency minor bug - fixed return type ‘matrix’ training function minor bug - fixed tf_idf function enhancement - added debug function enables tracking dimensions across learning steps enhancement - made number enhancements rust code","code":""},{"path":"https://furlan-lab.github.io/viewmastR/news/index.html","id":"viewmastr-v022","dir":"Changelog","previous_headings":"","what":"viewmastR v0.2.2","title":"viewmastR v0.2.2","text":"minor changes packaged actual release","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/viewmastR/news/index.html","id":"new-features-0-2-1","dir":"Changelog","previous_headings":"","what":"New features","title":"viewmastR v0.2.1","text":"use saved models minor bugs","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/viewmastR/news/index.html","id":"new-features-0-1-5","dir":"Changelog","previous_headings":"","what":"New features","title":"viewmastR v0.1.5","text":"splat_bulk_reference (released viewmastRust)","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/viewmastR/news/index.html","id":"new-features-0-1-4","dir":"Changelog","previous_headings":"","what":"New features","title":"viewmastR v0.1.4","text":"sfc color function (released viewmastRust)","code":""},{"path":"https://furlan-lab.github.io/viewmastR/news/index.html","id":"minor-bug-fixes-and-improvements-0-1-4","dir":"Changelog","previous_headings":"","what":"Minor bug fixes and improvements","title":"viewmastR v0.1.4","text":"many (released viewmastRust)","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/viewmastR/news/index.html","id":"new-features-0-1-2","dir":"Changelog","previous_headings":"","what":"New features","title":"viewmastR v0.1.2","text":"augment function (released viewmastRust)","code":""},{"path":"https://furlan-lab.github.io/viewmastR/news/index.html","id":"minor-bug-fixes-and-improvements-0-1-2","dir":"Changelog","previous_headings":"","what":"Minor bug fixes and improvements","title":"viewmastR v0.1.2","text":"many (released viewmastRust)","code":""},{"path":"https://furlan-lab.github.io/viewmastR/news/index.html","id":"viewmastr-v010","dir":"Changelog","previous_headings":"","what":"viewmastR v0.1.0","title":"viewmastR v0.1.0","text":"first stable version (released viewmastRust)","code":""}]
