% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extras.R
\name{get_weights}
\alias{get_weights}
\title{Extract linear-layer weights and map them to feature / class names}
\usage{
get_weights(dir)
}
\arguments{
\item{dir}{\code{character(1)}  Path to the artefact directory that contains
\emph{both} files produced by \code{run_custom()}:
\itemize{
\item \code{model.mpk}  – tensor weights saved via
\verb{NamedMpkFileRecorder::<FullPrecisionSettings>}
\item \code{meta.mpk}   – MessagePack blob created by \code{save_artifacts()}
holding \code{feature_names} and \code{class_labels}.
}}
}
\value{
A base-\code{data.frame} with dimension
\eqn{(\#\;features) \times (\#\;classes)}, where
\code{rownames(wmat)} are the feature names and
\code{colnames(wmat)} are the class labels.  Cell \emph{(i,j)} is the weight
connecting feature \emph{i} to logit \emph{j}.
}
\description{
Reads a model exported by the Rust Burn pipeline together with its
companion metadata file and returns a tidy \strong{weight matrix} whose rows
correspond to the original feature names and whose columns correspond to
the class labels.
}
\details{
Internally the function:
\enumerate{
\item deserialises the two MessagePack files with \strong{msgpackR};
\item raw‐decodes the tensor bytes through \code{decode_param()};
\item reshapes the flat vector into a column-major matrix using the stored
shape (\verb{[out_dim, in_dim]});
\item transposes it so that rows align with features;
\item re-labels rows and columns from the metadata lists.
}

The resulting object is ready for
\code{pheatmap()}, \code{corrplot()}, or \code{as.matrix()} for further analysis.
}
\examples{
\dontrun{
w <- get_weights("artifacts/run-42")
head(w[, 1:5])         # first 5 classes

# visualise top positive / negative features for class 3
cls <- 3
w_sorted <- w[order(w[, cls]), cls]
barplot(tail(w_sorted, 10), horiz = TRUE, las = 1)
barplot(head(w_sorted, 10), horiz = TRUE, las = 1)
}

}
\seealso{
\itemize{
\item \code{msgpack_read()} from \strong{msgpackR} – generic MessagePack reader
\item \code{decode_param()} – helper that converts Burn tensor blobs into R vectors
}
}
\keyword{internal}
